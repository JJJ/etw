!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.CS_generator=e()}}(function(){var define,module,exports;return function(){function e(t,n,o){function a(s,r){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n||e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)a(o[s]);return a}return e}()({1:[function(e,t,n){window.csg=window.csg||{},function(t,o){o.Templates=e("./templates"),o.template=function(){return this.Templates[1==arguments.length?arguments[0]:arguments.join("/")]},o.l18n=function(e){return csgData.strings[e]||""},o.Controls={base:e("./views/controls/base"),textfield:e("./views/controls/text"),textarea:e("./views/controls/text-area"),textarea_html:e("./views/controls/text-area"),dropdown:e("./views/controls/dropdown"),checkbox:e("./views/controls/checkbox"),colorpicker:e("./views/controls/colorpicker"),attach_image:e("./views/controls/image-upload")},o.controlLookup=function(e){return o.Controls[e]?o.Controls[e]:o.Controls.base};var a=e("./models/shortcode-collection"),i=e("./views/modal"),s=function(e){t(window).on("load",function(){this.shortcodes=new a,this.shortcodes.fetch({reset:!0})}.bind(this)),t(document).on("click","#cs-insert-shortcode-button",function(e){e.preventDefault(),this.openModal()}.bind(this))};s.prototype.openModal=function(){void 0===this.modalView&&(this.modalView=new i({collection:this.shortcodes,controller:this}))},s.prototype.deleteModal=function(){this.modalView=void 0},n.Controller=s,n.controller=new s}(jQuery,window.csg)},{"./models/shortcode-collection":4,"./templates":13,"./views/controls/base":17,"./views/controls/checkbox":18,"./views/controls/colorpicker":19,"./views/controls/dropdown":20,"./views/controls/image-upload":21,"./views/controls/text":23,"./views/controls/text-area":22,"./views/modal":24}],2:[function(e,t,n){t.exports=Backbone.Collection.extend({model:e("./control")})},{"./control":3}],3:[function(e,t,n){t.exports=Backbone.Model.extend({defaults:{param_name:"generic-param",heading:"Generic Control",description:"",type:"Generic",default_value:"",value:null}})},{}],4:[function(e,t,n){var o=Backbone.Collection.extend({model:e("./shortcode"),url:window.csgData.shortcodeCollectionUrl,selected:null,section:function(e){return bySection=this.filter(function(t){return t.get("section")===e}),new o(bySection)},setSelected:function(e){this.selected=e,this.trigger("new_selection")}});t.exports=o},{"./shortcode":5}],5:[function(e,t,n){t.exports=Backbone.Model.extend({defaults:{id:"generic-shortcode",title:"Generic Shortcode",icon:"icon",section:"Generic",description:"A Shortcode Description",params:[],demo:""},setSelected:function(){this.collection.setSelected(this)}})},{}],6:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <div class="csg-intro"> <p>',function(){__p+=__j.call(arguments,"")}(csg.l18n("blank-window")),__p+="</p> </div>";return __p}},{}],7:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <input type="checkbox" id="param-'+(null==(__t=param_name)?"":__t)+'" name="param-'+(null==(__t=param_name)?"":__t)+'" value="'+(null==(__t=value)?"":__t)+'">';return __p}},{}],8:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <input type="text" name="param-'+(null==(__t=param_name)?"":__t)+'" id="param-'+(null==(__t=param_name)?"":__t)+'" class="wp-color-picker" value="" size="30">';return __p}},{}],9:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <select name="param-'+(null==(__t=param_name)?"":__t)+'" id="param-'+(null==(__t=param_name)?"":__t)+'"> ',_.each(value,function(e,t){__p+=' <option value="',print(e.value||e),__p+='">',print(e.value?t:e),__p+=" </option> "}),__p+=" </select>";return __p}},{}],10:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <div class="csg-image-uploader"> <a href="#" class="csg-img-control set"><span class="dashicons dashicons-plus"></span></a> <a href="#" class="csg-img-control remove hidden"><span class="dashicons dashicons-no"></span></a> </div> <input type="hidden" name="param-'+(null==(__t=param_name)?"":__t)+'" id="param-'+(null==(__t=param_name)?"":__t)+'">';return __p}},{}],11:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <textarea name="param-'+(null==(__t=param_name)?"":__t)+'" id="param-'+(null==(__t=param_name)?"":__t)+'" rows="8" cols="5"></textarea>';return __p}},{}],12:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <label for="param-'+(null==(__t=param_name)?"":__t)+'"><strong>'+(null==(__t=heading)?"":__t)+"</strong><span>"+(null==(__t=description)?"":__t)+'</span></label> <input type="text" name="param-'+(null==(__t=param_name)?"":__t)+'" id="param-'+(null==(__t=param_name)?"":__t)+'" value="'+(null==(__t=value)?"":__t)+'" size="30">';return __p}},{}],13:[function(e,t,n){t.exports={"blank-state":e("./blank-state"),modal:e("./modal"),preview:e("./preview"),"controls/checkbox":e("./controls/checkbox"),"controls/color-picker":e("./controls/color-picker"),"controls/dropdown":e("./controls/dropdown"),"controls/image-upload":e("./controls/image-upload"),"controls/text-area":e("./controls/text-area"),"controls/text":e("./controls/text")}},{"./blank-state":6,"./controls/checkbox":7,"./controls/color-picker":8,"./controls/dropdown":9,"./controls/image-upload":10,"./controls/text":12,"./controls/text-area":11,"./modal":14,"./preview":15}],14:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <div class="csg-modal"> <header> <h1>'+(null==(__t=csg.l18n("modal-title"))?"":__t)+'</h1> <a class="csg-modal-btn csg-modal-toggle-advanced" href="#"> <span class="dashicons dashicons-media-code"></span> <span class="tip">'+(null==(__t=csg.l18n("modal-toggle-advanced"))?"":__t)+'</span> </a> <a class="csg-modal-btn csg-modal-close" href="#"> <span class="dashicons dashicons-no"></span> </a> </header> <div class="csg-modal-content"> <section class="csg-modal-sidebar"></section> <section class="csg-modal-main" role="main"></section> </div> <footer> <button id="btn-ok" disabled="disabled" class="button button-primary button-large">'+(null==(__t=csg.l18n("modal-insert-shortcode"))?"":__t)+'</button> </footer> </div> <div class="csg-modal-backdrop">&nbsp;</div>';return __p}},{}],15:[function(require,module,exports){module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",__p+=' <h2 class="csg-preview-title">',print(csg.l18n("preview-title")),__p+='</h2> <div class="csg-preview-content"> <p>',print(csgData.previewContentBefore),__p+='</p> <p><a class="button" href="'+(null==(__t=demo)?"":__t)+'" target="_blank">',print(csg.l18n("preview-button")),__p+="</a></p> <p>",print(csgData.previewContentAfter),__p+="</p> </div>";return __p}},{}],16:[function(e,t,n){var o=e("./controls/base");t.exports=Backbone.View.extend({className:"csg-modal-controls",render:function(){return this.collection.each(function(e){this.$el.append(o.makeControl(e.get("type"),{model:e}).render().$el)},this),this}})},{"./controls/base":17}],17:[function(e,t,n){t.exports=Backbone.View.extend({className:"csg-control",template:csg.template("controls/text"),renderSuper:function(){return 1==this.model.get("advanced")&&this.$el.addClass("advanced"),this.$el.html(this.template(this.model.toJSON())),this},render:function(){return this.renderSuper(),this.bindInput(),this},bindInput:function(){var e=this.model;e.set("data",this.$("#param-"+e.get("param_name")).val()),this.$("#param-"+e.get("param_name")).on("change",function(){e.set("data",jQuery(this).val())})}},{makeControl:function(e,t){return new(csg.controlLookup(e))(t)}})},{}],18:[function(e,t,n){var o=e("./base");t.exports=o.extend({template:csg.template("controls/checkbox"),bindInput:function(){var e=this.model;this.$("#param-"+e.get("param_name")).prop("checked")&&e.set("data",this.$("#param-"+e.get("param_name")).val()),this.$("#param-"+e.get("param_name")).on("change",function(){if(jQuery(this).prop("checked"))return void e.set("data",jQuery(this).val());e.unset("data")})}})},{"./base":17}],19:[function(e,t,n){var o=e("./base");t.exports=o.extend({template:csg.template("controls/color-picker"),render:function(){return this.renderSuper(),this.$(".wp-color-picker").wpColorPicker({change:this.colorChange.bind(this)}),this},colorChange:function(e,t){this.model.set("data",t.color.toString())},bindInput:function(){}})},{"./base":17}],20:[function(e,t,n){var o=e("./base");t.exports=o.extend({template:csg.template("controls/dropdown"),initialize:function(){this.model.set("selected",this.model.get("default_value")||_(this.model.get("value")).find(function(){return!0}))}})},{"./base":17}],21:[function(e,t,n){var o=e("./base"),a=o.extend({initialize:function(){a.createMediaFrame()},events:{"click a.csg-img-control.set":"setImage","click a.csg-img-control.remove":"removeImage"},template:csg.template("controls/image-upload"),setImage:function(e){e&&e.preventDefault();var t=a.uploader;t.off("insert"),t.on("insert",function(){data=t.state().get("selection").first().toJSON(),this.$("a.csg-img-control.set").addClass("hidden"),this.$("a.csg-img-control.remove").removeClass("hidden"),this.$(".csg-image-uploader").css({"background-image":"url("+data.url+")"}),this.$("input").val(data.url).change()}.bind(this)),t.open()},removeImage:function(e){e&&e.preventDefault(),this.$("a.csg-img-control.set").removeClass("hidden"),this.$("a.csg-img-control.remove").addClass("hidden"),this.$(".csg-image-uploader").css({"background-image":"none"}),this.$("input").val("")}},{uploader:null,createMediaFrame:function(){null==this.uploader&&(this.uploader=wp.media({frame:"post",state:"insert",multiple:!1}))}});t.exports=a},{"./base":17}],22:[function(e,t,n){var o=e("./base");t.exports=o.extend({template:csg.template("controls/text-area")})},{"./base":17}],23:[function(e,t,n){var o=e("./base");t.exports=o.extend()},{"./base":17}],24:[function(e,t,n){var o=e("./nav/main"),a=e("./window"),i=e("../models/control-collection");t.exports=Backbone.View.extend({id:"csgModal",className:"csg",template:csg.template("modal"),events:{"click .csg-modal-close":"close","click .csg-modal-toggle-advanced":"toggleAdvanced","click #btn-ok":"insertShortcode"},controls:null,initialize:function(e){this.controller=e.controller,this.listenTo(this.collection,"change:completed",this.render),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"new_selection",this.setupControls),this.on("controls_ready",this.renderWindow),this.collection.fetch({reset:!0}),this.render()},render:function(){this.$el.html(this.template()),this.$(".csg-modal-sidebar").append(new o({collection:this.collection}).render().$el),this.renderWindow(),this.getAdvancedState()&&this.setAdvancedState(!0),jQuery("body").append(this.$el).css({overflow:"hidden"}),this.$el.focus(),jQuery(document).on("focusin",function(e){this.$el[0]===e.target||this.$el.has(e.target).length||this.$el.focus()}.bind(this))},setupControls:function(){this.controls=new i(this.collection.selected.get("params")),this.trigger("controls_ready")},renderWindow:function(){null!==this.collection.selected&&this.$("#btn-ok").prop("disabled",!1),this.$(".csg-modal-main").html(new a({collection:this.controls,shortcode:this.collection.selected}).render().$el)},close:function(e){e&&e.preventDefault(),this.collection.selected=null,this.undelegateEvents(),jQuery(document).off("focusin",this.preserveFocus),jQuery("body").css({overflow:"auto"}),this.remove(),this.controller.deleteModal()},toggleAdvanced:function(e){e&&e.preventDefault(),this.setAdvancedState(!this.getAdvancedState())},getAdvancedState:function(){return"undefined"!=typeof Storage?(void 0===window.localStorage["csg-advanced-mode"]&&(window.localStorage["csg-advanced-mode"]=!1),"true"==window.localStorage["csg-advanced-mode"]):this.$el.hasClass("csg-advanced-enabled")},setAdvancedState:function(e){this.$(".csg-modal-toggle-advanced").removeClass("active"),this.$el.removeClass("csg-advanced-enabled"),e&&(this.$(".csg-modal-toggle-advanced").addClass("active"),this.$el.addClass("csg-advanced-enabled")),window.localStorage["csg-advanced-mode"]=e},insertShortcode:function(){var e={},t="",n=this.collection.selected.get("container")||!1;this.controls.each(function(o){var a=o.get("data"),i=o.get("param_name");if("content"==i&&(n=!0),void 0!==a&&""!=a){if("content"==i)return void(t=a);e[i]=a}});var o=this.collection.selected.get("id"),a="["+o;_(e).each(function(e,t){a+=" "+t+'="'+e+'"'}),a+="]",t&&(a+=t),n&&(a+="[/"+o+"]"),console.log("Inserting Shortcode: "+a),window.wp.media.editor.insert(a),this.close()}})},{"../models/control-collection":2,"./nav/main":26,"./window":29}],25:[function(e,t,n){t.exports=Backbone.View.extend({tagName:"li",events:{click:"click"},className:"csg-nav-item",render:function(){return this.$el.html(jQuery('<a href="#">'+this.model.get("title")+"</a>")),this},click:function(){this.model.setSelected()}})},{}],26:[function(e,t,n){var o=e("./section");t.exports=Backbone.View.extend({className:"csg-navigation",events:{"click li.csg-nav-item a":"click"},render:function(){return _(window.csgData.sectionNames).each(function(e){this.$el.append("<h3>"+e+"</h3>"),this.$el.append(new o({collection:this.collection.section(e)}).render().$el)}.bind(this)),this.$el.accordion({heightStyle:"content"}),this},click:function(e){this.$("li.csg-nav-item a").removeClass("active"),this.$(e.target).addClass("active")}})},{"./section":27}],27:[function(e,t,n){var o=e("./item");t.exports=Backbone.View.extend({className:"csg-nav-section",render:function(){return this.$el.append(jQuery("<ul></ul>")),this.collection.each(function(e){this.$("ul").append(new o({model:e}).render().$el)},this),this}})},{"./item":25}],28:[function(e,t,n){t.exports=Backbone.View.extend({className:"csg-preview",template:csg.template("preview"),render:function(){return this.$el.html(this.template(_.extend(this.model.toJSON(),this.data))),this}})},{}],29:[function(e,t,n){var o=e("./control-group"),a=e("./preview");t.exports=Backbone.View.extend({className:"csg-modal-window",template:csg.template("blank-state"),initialize:function(e){this.shortcode=e.shortcode},render:function(){return null==this.shortcode?(this.$el.html(this.template()),this):(this.$el.append(new o({collection:this.collection}).render().$el),this.$el.append(new a({model:this.shortcode}).render().$el),this)}})},{"./control-group":16,"./preview":28}]},{},[1])(1)});