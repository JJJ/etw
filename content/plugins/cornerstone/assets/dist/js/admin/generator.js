var generator=function(e){var t={};function n(o){if(t[o]){return t[o].exports}var a=t[o]={i:o,l:false,exports:{}};e[o].call(a.exports,a,a.exports,n);a.l=true;return a.exports}n.m=e;n.c=t;n.d=function(e,t,o){if(!n.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:o})}};n.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";return n(n.s=0)}([function(e,t,n){"use strict";var o=n(1);var a=i(o);function i(e){return e&&e.__esModule?e:{default:e}}window.csg=window.csg||{};var s=window.csg;var l=window._;var r=window.Backbone;s.Templates={"blank-state":'<div class="csg-intro"><p><% print(csg.l18n("blank-window")); %></p></div>',modal:'<div class="csg-modal"><header><h1><%= csg.l18n("modal-title") %></h1><a class="csg-modal-btn csg-modal-toggle-advanced" href="#"><span class="dashicons dashicons-media-code"></span><span class="tip"><%= csg.l18n("modal-toggle-advanced") %></span></a><a class="csg-modal-btn csg-modal-close" href="#"><span class="dashicons dashicons-no"></span></a></header><div class="csg-modal-content"><section class="csg-modal-sidebar"></section><section class="csg-modal-main" role="main"></section></div><footer><button id="btn-ok" disabled class="button button-primary button-large"><%= csg.l18n("modal-insert-shortcode") %></button></footer></div><div class="csg-modal-backdrop">&nbsp;</div>',preview:'<h2 class="csg-preview-title"><% print(csg.l18n("preview-title")); %></h2><div class="csg-preview-content"><p><% print(csgData.previewContentBefore) %></p><p><a class="button" href="<%= demo %>" target="_blank"><% print(csg.l18n("preview-button")); %></a></p><p><% print(csgData.previewContentAfter) %></p></div>',"controls/checkbox":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><input type="checkbox" id="param-<%= param_name %>" name="param-<%= param_name %>" value="<%= value %>" />',"controls/color-picker":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><input type="text" name="param-<%= param_name %>" id="param-<%= param_name %>" class="wp-color-picker" value="" size="30" />',"controls/dropdown":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><select name="param-<%= param_name %>" id="param-<%= param_name %>"><% _.each(value, function(option, name) { %><option value="<% print( option.value || option ) %>"><% print( (option.value) ? name : option) %> </option><% }); %></select>',"controls/image-upload":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><div class="csg-image-uploader"><a href="#" class="csg-img-control set"><span class="dashicons dashicons-plus"></span></a><a href="#" class="csg-img-control remove hidden"><span class="dashicons dashicons-no"></span></a></div><input type="hidden" name="param-<%= param_name %>" id="param-<%= param_name %>" />',"controls/text-area":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><textarea name="param-<%= param_name %>" id="param-<%= param_name %>" rows="8" cols="5"></textarea>',"controls/text":'<label for="param-<%= param_name %>"><strong><%= heading %></strong><span><%= description %></span></label><input type="text" name="param-<%= param_name %>" id="param-<%= param_name %>" value="<%= value %>" size="30" />'};s.template=function(){return l.template(this.Templates[arguments.length===1?arguments[0]:arguments.join("/")])};s.l18n=function(e){return window.csgData.strings[e]||""};var c={};var d={};c.Control=e.exports=r.Model.extend({defaults:{param_name:"generic-param",heading:"Generic Control",description:"",type:"Generic",default_value:"",value:null}});c.Shortcode=r.Model.extend({defaults:{id:"generic-shortcode",title:"Generic Shortcode",icon:"icon",section:"Generic",description:"A Shortcode Description",params:[],demo:""},setSelected:function e(){this.collection.setSelected(this)}});c.ShortcodeCollection=r.Collection.extend({model:c.Shortcode,url:window.csgData.shortcodeCollectionUrl,selected:null,section:function e(t){return new c.ShortcodeCollection(this.filter(function(e){return e.get("section")===t}))},setSelected:function e(t){this.selected=t;this.trigger("new_selection")}});c.ControlCollection=r.Collection.extend({model:c.Control});d.ControlBase=r.View.extend({className:"csg-control",template:s.template("controls/text"),renderSuper:function e(){if(this.model.get("advanced")===true){this.$el.addClass("advanced")}this.$el.html(this.template(this.model.toJSON()));return this},render:function e(){this.renderSuper();this.bindInput();return this},bindInput:function e(){var t=this.model;t.set("data",this.$("#param-"+t.get("param_name")).val());this.$("#param-"+t.get("param_name")).on("change",function(){t.set("data",(0,a.default)(this).val())})}},{makeControl:function e(t,n){var o={base:d.ControlBase,textfield:d.ControlText,textarea:d.ControlTextArea,textarea_html:d.ControlTextArea,dropdown:d.ControlDropdown,checkbox:d.ControlCheckbox,colorpicker:d.ControlColorPicker,attach_image:d.ControlImageUpload};var a=o[t]?o[t]:o["base"];return new a(n)}});d.ControlCheckbox=d.ControlBase.extend({template:s.template("controls/checkbox"),bindInput:function e(){var t=this.model;if(this.$("#param-"+t.get("param_name")).prop("checked")){t.set("data",this.$("#param-"+t.get("param_name")).val())}this.$("#param-"+t.get("param_name")).on("change",function(){if((0,a.default)(this).prop("checked")){t.set("data",(0,a.default)(this).val());return}t.unset("data")})}});d.ControlColorPicker=d.ControlBase.extend({template:s.template("controls/color-picker"),render:function e(){this.renderSuper();this.$(".wp-color-picker").wpColorPicker({change:this.colorChange.bind(this)});return this},colorChange:function e(t,n){this.model.set("data",n.color.toString())},bindInput:function e(){}});d.ControlDropdown=d.ControlBase.extend({template:s.template("controls/dropdown"),initialize:function e(){this.model.set("selected",this.model.get("default_value")||l(this.model.get("value")).find(function(){return true}))}});d.ControlImageUpload=d.ControlBase.extend({initialize:function e(){d.ControlImageUpload.createMediaFrame()},events:{"click a.csg-img-control.set":"setImage","click a.csg-img-control.remove":"removeImage"},template:s.template("controls/image-upload"),setImage:function e(t){if(t){t.preventDefault()}var n=d.ControlImageUpload.uploader;n.off("insert");n.on("insert",function(){var e=n.state().get("selection").first().toJSON();this.$("a.csg-img-control.set").addClass("hidden");this.$("a.csg-img-control.remove").removeClass("hidden");this.$(".csg-image-uploader").css({"background-image":"url("+e.url+")"});this.$("input").val(e.url).change()}.bind(this));n.open()},removeImage:function e(t){if(t){t.preventDefault()}this.$("a.csg-img-control.set").removeClass("hidden");this.$("a.csg-img-control.remove").addClass("hidden");this.$(".csg-image-uploader").css({"background-image":"none"});this.$("input").val("")}},{uploader:null,createMediaFrame:function e(){if(this.uploader===null){this.uploader=window.wp.media({frame:"post",state:"insert",multiple:false})}}});d.ControlTextArea=d.ControlBase.extend({template:s.template("controls/text-area")});d.ControlText=d.ControlBase.extend({});d.ControlGroup=r.View.extend({className:"csg-modal-controls",render:function e(){this.collection.each(function(e){this.$el.append(d.ControlBase.makeControl(e.get("type"),{model:e}).render().$el)},this);return this}});d.NavItem=r.View.extend({tagName:"li",events:{click:"click"},className:"csg-nav-item",render:function e(){this.$el.html((0,a.default)('<a href="#">'+this.model.get("title")+"</a>"));return this},click:function e(){this.model.setSelected()}});d.NavSection=r.View.extend({className:"csg-nav-section",render:function e(){this.$el.append((0,a.default)("<ul></ul>"));this.collection.each(function(e){this.$("ul").append(new d.NavItem({model:e}).render().$el)},this);return this}});d.Nav=r.View.extend({className:"csg-navigation",events:{"click li.csg-nav-item a":"click"},render:function e(){l(window.csgData.sectionNames).each(function(e){this.$el.append("<h3>"+e+"</h3>");this.$el.append(new d.NavSection({collection:this.collection.section(e)}).render().$el)}.bind(this));this.$el.accordion({heightStyle:"content"});return this},click:function e(t){this.$("li.csg-nav-item a").removeClass("active");this.$(t.target).addClass("active")}});d.Preview=r.View.extend({className:"csg-preview",template:s.template("preview"),render:function e(){this.$el.html(this.template(l.extend(this.model.toJSON(),this.data)));return this}});d.Window=r.View.extend({className:"csg-modal-window",template:s.template("blank-state"),initialize:function e(t){this.shortcode=t.shortcode},render:function e(){if(this.shortcode===null){this.$el.html(this.template());return this}this.$el.append(new d.ControlGroup({collection:this.collection}).render().$el);this.$el.append(new d.Preview({model:this.shortcode}).render().$el);return this}});d.Modal=r.View.extend({id:"csgModal",className:"csg",template:s.template("modal"),events:{"click .csg-modal-close":"close","click .csg-modal-toggle-advanced":"toggleAdvanced","click #btn-ok":"insertShortcode"},controls:null,initialize:function e(t){this.controller=t.controller;this.listenTo(this.collection,"change:completed",this.render);this.listenTo(this.collection,"reset",this.render);this.listenTo(this.collection,"new_selection",this.setupControls);this.on("controls_ready",this.renderWindow);this.collection.fetch({reset:true});this.render()},render:function e(){this.$el.html(this.template());this.$(".csg-modal-sidebar").append(new d.Nav({collection:this.collection}).render().$el);this.renderWindow();if(this.getAdvancedState()){this.setAdvancedState(true)}(0,a.default)("body").append(this.$el).css({overflow:"hidden"});this.$el.focus();(0,a.default)(document).on("focusin",function(e){if(this.$el[0]!==e.target&&!this.$el.has(e.target).length){this.$el.focus()}}.bind(this))},setupControls:function e(){this.controls=new c.ControlCollection(this.collection.selected.get("params"));this.trigger("controls_ready")},renderWindow:function e(){if(this.collection.selected!==null){this.$("#btn-ok").prop("disabled",false)}this.$(".csg-modal-main").html(new d.Window({collection:this.controls,shortcode:this.collection.selected}).render().$el)},close:function e(t){if(t){t.preventDefault()}this.collection.selected=null;this.undelegateEvents();(0,a.default)(document).off("focusin",this.preserveFocus);(0,a.default)("body").css({overflow:"auto"});this.remove();this.controller.deleteModal()},toggleAdvanced:function e(t){if(t){t.preventDefault()}this.setAdvancedState(!this.getAdvancedState())},getAdvancedState:function e(){if(typeof Storage!=="undefined"){if(window.localStorage["csg-advanced-mode"]===undefined){window.localStorage["csg-advanced-mode"]=false}return window.localStorage["csg-advanced-mode"]==="true"}return this.$el.hasClass("csg-advanced-enabled")},setAdvancedState:function e(t){this.$(".csg-modal-toggle-advanced").removeClass("active");this.$el.removeClass("csg-advanced-enabled");if(t){this.$(".csg-modal-toggle-advanced").addClass("active");this.$el.addClass("csg-advanced-enabled")}window.localStorage["csg-advanced-mode"]=t},insertShortcode:function e(){var t={};var n="";var o=this.collection.selected.get("container")||false;this.controls.each(function(e){var a=e.get("data"),i=e.get("param_name");if(i==="content"){o=true}if(a!==undefined&&""!==a){if(i==="content"){n=a;return}t[i]=a}});var a=this.collection.selected.get("id");var i="["+a;l(t).each(function(e,t){i+=" "+t+'="'+e+'"'});i+="]";if(n){i+=n}if(o){i+="[/"+a+"]"}console.log("Inserting Shortcode: "+i);window.wp.media.editor.insert(i);this.close()}});var p=function e(){(0,a.default)(window).on("load",function(){this.shortcodes=new c.ShortcodeCollection;this.shortcodes.fetch({reset:true})}.bind(this));(0,a.default)(document).on("click","#cs-insert-shortcode-button",function(e){e.preventDefault();this.openModal()}.bind(this))};p.prototype.openModal=function(){if(this.modalView===undefined){this.modalView=new d.Modal({collection:this.shortcodes,controller:this})}};p.prototype.deleteModal=function(){this.modalView=undefined};t.Controller=p;t.controller=new p},function(e,t){e.exports=window.jQuery}]);
//# sourceMappingURL=generator.js.map