"use strict";(function(){var w=[].indexOf;jQuery(document).ready(function(d){var t,e,i,a,n,r,s,c,o,_,p,u,l,h,f,m;if(m=null!=(l=window.typenow)?l:"",u=null!=(h=window.pagenow)?h:"","product"===m&&wc_square_admin_products.is_product_sync_enabled)return"edit-product"===u&&d("button.editinline").on("click",function(e){var r,t,o;return r=d(this).closest("tr"),o=r.find("th.check-column input").val(),t={action:"wc_square_is_product_synced_with_square",security:wc_square_admin_products.is_product_synced_with_square_nonce,product_id:r.find("th.check-column input").val()},d.post(wc_square_admin_products.ajax_url,t,function(e){var r,t,i,a,n,s,c;if(r=d("tr#edit-"+o),n=r.find("select.square-synced"),a=r.find("input[name=_sku]"),i=r.find("input[name=_manage_stock]"),c=r.find("select[name=_stock_status]"),s=r.find("input[name=_stock]"),t=r.find(".wc-square-sync-with-square-errors"),e&&e.data)return"multiple_attributes"===e.data?(n.prop("checked",!1),n.prop("disabled",!0),void t.find(".multiple_attributes").show()):(n.val("missing_sku"===e.data?"no":e.data),a.on("change keyup keypress",function(e){return""===d(this).val()?(n.val("no"),n.prop("disabled",!0),t.find(".missing_sku").show()):(n.prop("disabled",!1),n.trigger("change"),t.find(".missing_sku").hide())}).trigger("change"),n.on("change",function(e){return"no"===d(this).val()?(i.prop("disabled",!1),c.prop("disabled",!1),s.prop("disabled",!1)):(i.prop("checked",!0),d(".stock_qty_field").show(),i.prop("disabled",!0),c.prop("disabled",!0),s.prop("disabled",!0))}).trigger("change"))})}),"product"===u?(f="#_"+wc_square_admin_products.synced_with_square_taxonomy,o=function(){var e;return e=d("#product-type").val(),0<=w.call(wc_square_admin_products.variable_product_types,e)},c=function(){return""!==d("#_sku").val()},s=function(){var e;return e=d('.woocommerce_attribute_data input[name^="attribute_variation"]:checked'),o()&&e&&1<e.length},r=function(r){return d("#variable_product_options").on("reload",function(e){return s()?(d(".wc-square-sync-with-square-error.multiple_attributes").show(),d(r).prop("disabled",!0),d(r).prop("checked",!1)):(d(".wc-square-sync-with-square-error.multiple_attributes").hide(),c()&&d(r).prop("disabled",!1)),d(r).trigger("change")}).trigger("reload")},function(r){if(!o())return d("#_sku").on("change keypress keyup",function(e){return""===d(this).val()?(d(".wc-square-sync-with-square-error.missing_sku").show(),d(r).prop("disabled",!0),d(r).prop("checked",!1)):(d(".wc-square-sync-with-square-error.missing_sku").hide(),s()||d(r).prop("disabled",!1)),d(r).trigger("change")}).trigger("change")}(f),r(f),a=d(".stock_fields"),n=a.find("#_stock"),e=d("._manage_stock_field"),i=e.find("#_manage_stock"),t=e.find(".description"),_=t.text(),p=d("#_manage_stock").is(":checked"),d(f).on("change",function(e){var s,r;if(wc_square_admin_products.is_inventory_sync_enabled)return r=-1!==d.inArray(d("#product-type").val(),wc_square_admin_products.variable_product_types),d(this).is(":checked")&&0<d("#_square_item_variation_id").length?(s=!0,t.html('<a href="'+wc_square_admin_products.settings_url+'">'+wc_square_admin_products.i18n.synced_with_square+"</a>"),i.prop("disabled",!0).prop("checked",!r).change(),n.prop("readonly",!0),r||a.show(),wc_square_admin_products.is_woocommerce_sor&&!r?(0===d("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;"><a href="#" id="fetch-stock-with-square">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),d("#fetch-stock-with-square").on("click",function(e){var t,r;return e.preventDefault(),(t=d("p._stock_field span.description .spinner")).css("visibility","visible"),r={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:d("#post_ID").val()},d.post(wc_square_admin_products.ajax_url,r,function(e){var r;return e&&e.success?(r=e.data,n.val(r),a.find("input[name=_original_stock]").val(r),n.prop("readonly",!1),d("p._stock_field span.description").remove()):(e.data&&(d(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):wc_square_admin_products.is_square_sor&&0===d("p._stock_field span.description").length&&n.after('<span class="description" style="display:block;clear:both;">'+wc_square_admin_products.i18n.managed_by_square+"</span>")):(s=!1,d("p._stock_field span.description").remove(),n.prop("readonly",!1),t.html(_),i.prop("disabled",!1).prop("checked",p),p&&a.show()),d(".woocommerce_variation").each(function(){var e,r,i,a,t,n;return n=d(this).find("h3 > a").attr("rel"),e=(r=d(".variable_manage_stock")).parent(),a=d(this).find(".wc_input_stock"),i=a.parent(),s?(r.prop("disabled",!0).prop("checked",!0).change(),a.prop("readonly",!0),d("#wc_square_variation_manage_stock").prop("disabled",!1),0===e.find(".description").length&&r.after('<span class="description">('+wc_square_admin_products.i18n.managed_by_square+")</span>"),wc_square_admin_products.is_woocommerce_sor?(t="fetch-stock-with-square-"+n,0===i.find("span.description").length&&a.after('<span class="description" style="display:block;clear:both;"><a href="#" id="'+t+'">'+wc_square_admin_products.i18n.fetch_stock_with_square+'</a><div class="spinner" style="float:none;"></div></span>'),d("#"+t).on("click",function(e){var t,r;return e.preventDefault(),(t=d(this).next(".spinner")).css("visibility","visible"),r={action:"wc_square_fetch_product_stock_with_square",security:wc_square_admin_products.fetch_product_stock_with_square_nonce,product_id:n},d.post(wc_square_admin_products.ajax_url,r,function(e){var r;return e&&e.success?(r=e.data,a.val(r),i.parent().find('input[name^="variable_original_stock"]').val(r),a.prop("readonly",!1),i.find(".description").remove()):(e.data&&(d(".inventory-fetch-error").remove(),t.after('<span class="inventory-fetch-error" style="display:inline-block;color:red;">'+e.data+"</span>")),t.css("visibility","hidden"),console.log(e))})})):void 0):(a.prop("readonly",!1),r.prop("disabled",!1),r.next(".description").remove(),d("#wc_square_variation_manage_stock").prop("disabled",!0))})}).trigger("change"),d("#product-type").on("change",function(e){return d(f).trigger("change")}),d("#woocommerce-product-data").on("woocommerce_variations_loaded",function(e){return d(f).trigger("change")})):void 0})}).call(void 0);
//# sourceMappingURL=wc-square-admin-products.min.js.map
